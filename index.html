<!DOCTYPE html>
<div class="camera" style="border-style:solid;border-color:blue; width:100%; height:100%;">

  <video id="video">

  </video>

  <button id="startbutton" style="position=relative";>Take photo</button>
</div>

<canvas id="canvas"> </canvas>
<div class="output">
  <img id="photo" alt="The screen capture will appear in this box." />
</div>

<script>
const width = 320;    // We will scale the photo width to this
const height = 200;     // This will be computed based on the input stream

const streaming = false;

let video = document.getElementById('video');
video.setAttribute("width", width);
video.setAttribute("height", height);
video.style.position = "absolute";
video.style.width = "50%";
video.style.height = "50%";
video.style.top = "25%";
video.style.left = "25%";
let canvas = document.getElementById('canvas');
let photo = document.getElementById('photo');
let startbutton = document.getElementById('startbutton');

let boundbox = document.createElement("div");
boundbox.style.width = "20%";
boundbox.style.height = "20%";
boundbox.style.borderStyle = "solid";
boundbox.style.borderColor = "red";
// boundbox.style.zIndex = "1";
boundbox.style.position = "absolute";
boundbox.style.top = "40%";
boundbox.style.left = "40%";
//     <div id="square" style="width: 10px; height: 10px;   border-style: solid;
//   border-color: red; z-index: 1; position: absolute; top: 100px; left: 160px">
//     </div>

navigator.mediaDevices
  .getUserMedia({ video: true, audio: false })
  .then((stream) => {
    video.srcObject = stream;
    video.play();
    document.getElementById("video").after(boundbox);
  })
  .catch((err) => {
    console.error(`An error occurred: ${err}`);
  });
  
// video.addEventListener(
//   "canplay",
//   (ev) => {
//     if (!streaming) {
//       height = (video.videoHeight / video.videoWidth) * width;
// 
//       video.setAttribute("width", width);
//       video.setAttribute("height", height);
//       canvas.setAttribute("width", width);
//       canvas.setAttribute("height", height);
//       streaming = true;
//     }
//   },
//   false
// );
startbutton.addEventListener(
  "click",
  (ev) => {
    takepicture();
    ev.preventDefault();
  },
  false
);

function takepicture() {
  const context = canvas.getContext("2d");
  if (width && height) {
    canvas.width = width;
    canvas.height = height;
    context.drawImage(video, 0, 0, width, height);

    //const data = canvas.toDataURL("image/png");
    //photo.setAttribute("src", data);
  } else {
    clearphoto();
  }
}
  
  

</script>
